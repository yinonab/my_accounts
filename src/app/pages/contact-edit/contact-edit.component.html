<div class="contact-edit-container" *ngIf="contact">
  <section class="flex column contact-edit">
    <form [formGroup]="form" (ngSubmit)="onSaveContact()" class="flex column">
      <h2>{{ contact._id ? 'Edit' : 'Add' }} Contact</h2>

      <!-- Name Input -->
      <div class="form-input">
        <label for="name">Name</label>
        <input formControlName="name" placeholder="Contact Name" id="name" />
      </div>
      <ng-container *ngIf="form.controls['name'] as nameInput">
        <p *ngIf="nameInput.errors && nameInput.touched" class="errors">
          <span *ngIf="nameInput.errors['required']">Name is required!</span>
          <span *ngIf="nameInput.errors['minlength']">Name must be at least 3 characters long!</span>
        </p>
      </ng-container>

      <!-- Owner Input -->
      <div class="form-input">
        <label for="owner">Owner</label>
        <input formControlName="owner" placeholder="Owner Name" id="owner" />
      </div>

      <!-- Dynamic Fields Section -->
      <div *ngFor="let field of fields.controls; let i = index" class="form-input">
        <label [for]="field.value.label">{{ field.value.label }}</label>
        <input *ngIf="field.value.type === 'text'" formControlName="value" />
        <input *ngIf="field.value.type === 'file'" type="file" (change)="onFileSelected($event)" />
        <button type="button" (click)="removeField(i)">Remove</button>
      </div>

      <!-- Add Fields Button -->
      <button type="button" (click)="addField('New Field', 'text')">Add Field</button>

      <!-- Media Upload -->
      <button type="button" (click)="toggleMediaUpload()">Toggle Media Upload</button>
      <div *ngIf="showMediaUpload">
        <input type="file" (change)="onFileSelected($event)" />
      </div>

      <!-- Save Button -->
      <div class="form-actions">
        <button [disabled]="form.invalid" class="save-btn" type="submit">Save</button>
      </div>
    </form>
  </section>
</div>